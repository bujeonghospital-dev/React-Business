# คู่มือการใช้งานฟีเจอร์ลบข้อมูลหลายรายการพร้อมกัน

## ภาพรวม

ฟีเจอร์นี้ช่วยให้สามารถเลือกและลบข้อมูลลูกค้าหลายรายการพร้อมกันได้ โดยไม่ต้องลบทีละรายการ

## วิธีการใช้งาน

### 1. เลือกข้อมูลที่ต้องการลบ

- **เลือกทั้งหมด**: คลิก checkbox ที่หัวตาราง (คอลัมน์แรก) เพื่อเลือกข้อมูลทั้งหมดในหน้าปัจจุบัน
- **เลือกเฉพาะรายการ**: คลิก checkbox ที่แต่ละแถวที่ต้องการลบ
- แถวที่ถูกเลือกจะมีพื้นหลังสีฟ้าอ่อน

### 2. ลบข้อมูล

- เมื่อเลือกอย่างน้อย 1 รายการแล้ว ปุ่ม **"ลบที่เลือก (X)"** จะปรากฏขึ้น (X คือจำนวนรายการที่เลือก)
- คลิกปุ่มลบสีแดง
- ระบบจะแสดงข้อความยืนยันพร้อมแสดง ID ทั้งหมดที่จะถูกลบ
- คลิก OK เพื่อยืนยันการลบ หรือ Cancel เพื่อยกเลิก

### 3. ผลลัพธ์

- หลังจากลบสำเร็จ ระบบจะแสดงข้อความแจ้งจำนวนรายการที่ถูกลบ
- ข้อมูลในตารางจะรีเฟรชอัตโนมัติ
- รายการที่เลือก (checkboxes) จะถูก clear

## ข้อควรระวัง

⚠️ **คำเตือน**: การลบข้อมูลไม่สามารถย้อนกลับได้ กรุณาตรวจสอบให้แน่ใจก่อนยืนยันการลบ

## ตัวอย่างการใช้งาน

### สถานการณ์ที่ 1: ลบข้อมูลที่มีสถานะเฉพาะ

1. ใช้ filter สถานะเพื่อกรองข้อมูล
2. เลือก checkbox ทั้งหมด
3. คลิกปุ่มลบ

### สถานการณ์ที่ 2: ลบข้อมูลเฉพาะ ID ที่ต้องการ

1. ค้นหาข้อมูลด้วยการกรองหรือค้นหา
2. เลือก checkbox เฉพาะแถวที่ต้องการลบ
3. คลิกปุ่มลบ

## เทคนิค

- **การเลือกหลายรายการอย่างรวดเร็ว**:
  - กรองข้อมูลด้วยเงื่อนไขที่ต้องการ
  - คลิก checkbox เลือกทั้งหมด
  - ยกเลิกการเลือกรายการที่ไม่ต้องการลบ (ถ้ามี)
- **การตรวจสอบก่อนลบ**:
  - ข้อความยืนยันจะแสดง ID ทั้งหมดที่จะถูกลบ
  - ตรวจสอบ ID ให้ละเอียดก่อนคลิก OK

## API Endpoint

### DELETE Multiple Records

```
POST /api/customer-data
Content-Type: application/json

{
  "action": "deleteMultiple",
  "data": {
    "ids": [1, 2, 3, 4, 5]
  }
}
```

### Response Success

```json
{
  "success": true,
  "message": "ลบข้อมูลสำเร็จ 5 รายการ",
  "deletedCount": 5,
  "deletedIds": [1, 2, 3, 4, 5]
}
```

### Response Error

```json
{
  "success": false,
  "error": "กรุณาระบุ ID ที่ต้องการลบ"
}
```

## การทดสอบ

### ทดสอบผ่าน UI

1. เปิดหน้า Customer All Data
2. เลือก checkbox หลายรายการ
3. คลิกปุ่มลบและยืนยัน
4. ตรวจสอบว่าข้อมูลถูกลบสำเร็จ

### ทดสอบผ่าน API

```bash
# ใช้ PowerShell
$body = @{
    action = "deleteMultiple"
    data = @{
        ids = @(1, 2, 3)
    }
} | ConvertTo-Json

Invoke-RestMethod -Uri "http://localhost:3000/api/customer-data" `
  -Method Post `
  -Body $body `
  -ContentType "application/json"
```

## สิทธิ์การใช้งาน

ทุก role สามารถใช้ฟีเจอร์นี้ได้ แต่:

- **User ทั่วไป**: จะเห็นและลบได้เฉพาะข้อมูลของตนเอง
- **Admin/Superadmin**: สามารถเห็นและลบข้อมูลทั้งหมดได้

## การแก้ไขปัญหา

### ปัญหา: ปุ่มลบไม่ปรากฏ

- ตรวจสอบว่าได้เลือก checkbox อย่างน้อย 1 รายการแล้ว

### ปัญหา: ไม่สามารถลบได้

- ตรวจสอบว่ามีสิทธิ์ในการลบข้อมูลนั้น
- ตรวจสอบ console log เพื่อดู error message

### ปัญหา: ข้อมูลไม่รีเฟรชหลังลบ

- คลิกปุ่มรีเฟรชด้วยตนเอง
- ตรวจสอบ network tab ว่า API ตอบกลับสำเร็จหรือไม่

## หมายเหตุ

- การลบจะดำเนินการที่ฐานข้อมูลทันที
- ข้อมูลที่ลบไปแล้วไม่สามารถกู้คืนได้
- ควรสำรองข้อมูลสำคัญก่อนทำการลบจำนวนมาก
