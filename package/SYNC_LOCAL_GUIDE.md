# üöÄ Quick Guide: Sync Google Sheets to Database (Local)

## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ngrok (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î localhost ‡πÉ‡∏´‡πâ Google Sheets ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ)

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î ngrok

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà https://ngrok.com/download
2. ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Windows
3. ‡πÅ‡∏ï‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á `ngrok.exe` ‡πÉ‡∏ô folder ‡∏ô‡∏µ‡πâ

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ú‡πà‡∏≤‡∏ô Chocolatey (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)

```powershell
choco install ngrok
```

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 3: ‡πÉ‡∏ä‡πâ Cloudflare Tunnel (‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)

```powershell
npm install -g cloudflared
cloudflared tunnel --url http://localhost:3000
```

---

## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏õ‡∏¥‡∏î Tunnel

### ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ ngrok:

```powershell
# Terminal 1: ‡∏£‡∏±‡∏ô Next.js server
npm run dev

# Terminal 2: ‡∏£‡∏±‡∏ô ngrok
.\ngrok.exe http 3000
# ‡∏´‡∏£‡∏∑‡∏≠
ngrok http 3000
```

‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ ‡πÄ‡∏ä‡πà‡∏ô: `https://abc123.ngrok-free.app`

### ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ Cloudflare:

```powershell
# Terminal 1: ‡∏£‡∏±‡∏ô Next.js server
npm run dev

# Terminal 2: ‡∏£‡∏±‡∏ô cloudflared
cloudflared tunnel --url http://localhost:3000
```

---

## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Apps Script

1. ‡πÄ‡∏õ‡∏¥‡∏î Google Sheets "Film data"
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **Extensions** ‚Üí **Apps Script**
3. ‡∏•‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
4. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å `docs/google-apps-script-local.js`
5. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `API_ENDPOINT`:
   ```javascript
   const API_ENDPOINT =
     "https://YOUR-NGROK-URL.ngrok-free.app/api/webhooks/surgery-schedule";
   ```
6. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (Ctrl+S)
7. ‡∏£‡∏±‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `testConnection` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö

---

## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

1. ‡πÉ‡∏ô Google Sheets, ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏°‡∏ô‡∏π **üîÑ Sync to Database**
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **üì§ Send All Data**
3. ‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà ‡∏à‡∏∞‡∏°‡∏µ alert ‡∏ö‡∏≠‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå

---

## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 5: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Auto-Sync (Optional)

‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Google Sheets:

1. ‡πÉ‡∏ô Apps Script Editor, ‡∏Ñ‡∏•‡∏¥‡∏Å **‚è∞ Triggers** (‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢)
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **+ Add Trigger**
3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤:
   - Function: `onSheetEdit`
   - Event source: `From spreadsheet`
   - Event type: `On edit`
4. ‡∏Ñ‡∏•‡∏¥‡∏Å **Save**
5. Authorize (Allow permissions)

‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡πÑ‡∏õ ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheets ‡∏à‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Database ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥! üéâ

---

## Troubleshooting

### ‚ùå Error: "Failed to fetch"

- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ ngrok/cloudflared ‡∏¢‡∏±‡∏á‡∏£‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Next.js server ‡∏¢‡∏±‡∏á‡∏£‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà
- ‡∏•‡∏≠‡∏á‡∏£‡∏±‡∏ô `testConnection` ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á

### ‚ùå Error: "Unauthorized"

- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ `WEBHOOK_SECRET` ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô

### ‚ùå Error: "Sheet not found"

- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ä‡∏∑‡πà‡∏≠ sheet ‡πÄ‡∏õ‡πá‡∏ô "Film data" (‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å‡πÉ‡∏´‡∏ç‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô)

---

## üéØ ‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∑‡πà‡∏ô: Deploy ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Vercel (Production)

‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏ä‡πâ ngrok ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á:

1. Deploy ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡πÑ‡∏õ‡∏¢‡∏±‡∏á Vercel
2. ‡πÉ‡∏ä‡πâ `docs/google-apps-script-webhook.js` ‡πÅ‡∏ó‡∏ô
3. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `API_ENDPOINT` ‡πÄ‡∏õ‡πá‡∏ô Production URL

‡∏î‡∏π `WEBHOOK_INTEGRATION_GUIDE.md` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î

---

## Summary

‚úÖ Local API ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà localhost:3000
‚úÖ ‡πÉ‡∏ä‡πâ ngrok/cloudflared ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ Google Sheets ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á
‚úÖ ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Google Apps Script ‡πÅ‡∏•‡πâ‡∏ß
‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢ Test Connection
‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏î‡πâ‡∏ß‡∏¢ Send All Data
‚úÖ (Optional) ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Auto-Sync

**Next Steps:**

1. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ngrok ‡∏´‡∏£‡∏∑‡∏≠ cloudflared
2. ‡πÄ‡∏õ‡∏¥‡∏î tunnel
3. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL ‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô Apps Script
4. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•!

---

**‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢**: GitHub Copilot  
**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà**: 12 ‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô 2025
