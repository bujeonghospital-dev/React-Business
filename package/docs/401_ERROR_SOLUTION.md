# üîß ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç 401 Error - SET API

## üéØ ‡∏õ‡∏±‡∏ç‡∏´‡∏≤

```json
{
  "error": "Failed to fetch stock data",
  "message": "SET API returned 401"
}
```

## üîç ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏

**SET Market Data API** ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:

1. **API Key ‡πÅ‡∏ö‡∏ö Production** (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà demo key)
2. **‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å** ‡∏Å‡∏±‡∏ö SET Marketplace
3. **IP Whitelist** (‡∏ö‡∏≤‡∏á‡∏Å‡∏£‡∏ì‡∏µ)
4. **OAuth 2.0** ‡∏´‡∏£‡∏∑‡∏≠ authentication ‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏ß‡πà‡∏≤

API Key `461b3d65-d964-4d93-97a0-79b670d3867f` ‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô **demo key** ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Å‡∏±‡∏ö production endpoint

---

## ‚úÖ ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡πÉ‡∏ä‡πâ Mock Data (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Demo) ‚≠ê

**‡∏Ç‡πâ‡∏≠‡∏î‡∏µ:**

- ‚úÖ ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠ API
- ‚úÖ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢
- ‚úÖ ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ 100%
- ‚úÖ ‡πÑ‡∏°‡πà‡∏°‡∏µ rate limit
- ‚úÖ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö prototype ‡πÅ‡∏•‡∏∞ demo

**‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢:**

- ‚ùå ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á real-time
- ‚ùå ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠

**‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:**
Mock data ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡πÉ‡∏ô `src/data/mockStockData.ts` ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 10 ‡∏´‡∏∏‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏à‡∏£‡∏¥‡∏á:

- TVO, PTT, KBANK, CPALL, AOT
- ADVANC, TRUE, SCB, BDMS, GULF

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• "‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß" ‡∏ó‡∏∏‡∏Å 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

---

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡∏™‡∏°‡∏±‡∏Ñ‡∏£ SET API ‡πÅ‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Production)

#### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£:

1. **‡πÑ‡∏õ‡∏ó‡∏µ‡πà SET Marketplace**

   ```
   https://marketplace.set.or.th/
   ```

2. **‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ Developer**

   - ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó
   - ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô (‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó)

3. **Subscribe API Package**

   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Realtime Stock Data API"
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à (Free/Paid)
   - ‡∏£‡∏≠ approval (1-3 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£)

4. **‡∏£‡∏±‡∏ö Production API Key**

   - ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
   - ‡∏à‡∏∞‡πÑ‡∏î‡πâ API Key ‡πÅ‡∏ö‡∏ö production
   - ‡∏≠‡∏≤‡∏à‡πÑ‡∏î‡πâ API Secret ‡∏î‡πâ‡∏ß‡∏¢

5. **‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Whitelist (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)**
   - ‡πÄ‡∏û‡∏¥‡πà‡∏° IP address ‡∏Ç‡∏≠‡∏á server
   - ‡∏´‡∏£‡∏∑‡∏≠ domain name

#### ‡∏£‡∏≤‡∏Ñ‡∏≤ (‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì):

- **Free Tier**: 100-500 requests/day
- **Basic**: ~‡∏ø5,000/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (5,000 requests/day)
- **Professional**: ~‡∏ø20,000/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (unlimited)
- **Enterprise**: ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ SET

---

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 3: ‡πÉ‡∏ä‡πâ API ‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏î‡πÅ‡∏ó‡∏ô

#### 3.1 Alpha Vantage (Free + Paid)

```
https://www.alphavantage.co/
```

- ‚úÖ ‡∏°‡∏µ Free tier (500 requests/day)
- ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏∏‡πâ‡∏ô‡πÑ‡∏ó‡∏¢ (SET)
- ‚úÖ ‡∏á‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

```typescript
// ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
const API_KEY = "YOUR_ALPHA_VANTAGE_KEY";
const url = `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=TVO.BK&apikey=${API_KEY}`;
```

#### 3.2 Finnhub (Free + Paid)

```
https://finnhub.io/
```

- ‚úÖ Free tier: 60 requests/minute
- ‚úÖ Real-time data
- ‚úÖ WebSocket support

#### 3.3 IEX Cloud (Paid)

```
https://iexcloud.io/
```

- ‚úÖ High-quality data
- ‚úÖ Good documentation
- ‚ùå Paid only

---

## üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

### ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ:

1. **‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏° fetch ‡∏à‡∏≤‡∏Å SET API**

   - ‡∏•‡∏≠‡∏á 3 ‡∏ß‡∏¥‡∏ò‡∏µ authentication:
     - Bearer Token
     - X-API-Key
     - Both

2. **‡∏ñ‡πâ‡∏≤ API ‡∏•‡πâ‡∏° (401)**

   - ‚úÖ fallback ‡πÑ‡∏õ Mock Data
   - ‚úÖ ‡πÅ‡∏™‡∏î‡∏á "üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏∏‡πâ‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (Demo Data)"
   - ‚úÖ user ‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô error

3. **Mock Data ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏à‡∏£‡∏¥‡∏á**
   - Random variation ‡∏ó‡∏∏‡∏Å 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
   - ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡πÅ‡∏ö‡∏ö realistic
   - Volume ‡πÅ‡∏•‡∏∞ Value ‡∏™‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏°‡∏ú‡∏•

---

## üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

### ‚úÖ ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ:

- ‡∏´‡∏ô‡πâ‡∏≤ investor-financials ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏õ‡∏Å‡∏ï‡∏¥
- Stock widget ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• TVO
- Market Overview ‡πÅ‡∏™‡∏î‡∏á Top 10 ‡∏´‡∏∏‡πâ‡∏ô
- Auto-refresh ‡∏ó‡∏∏‡∏Å 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- ‡πÑ‡∏°‡πà‡∏°‡∏µ error ‡πÉ‡∏´‡πâ user ‡πÄ‡∏´‡πá‡∏ô

### ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î:

- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô demo data (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà real-time)
- ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏Ñ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠ (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥)

### üéØ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö:

- ‚úÖ Prototype/Demo
- ‚úÖ Development environment
- ‚úÖ Investor presentation
- ‚úÖ UI/UX testing

### ‚ùå ‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö:

- ‚ùå Production trading platform
- ‚ùå Financial analysis tools
- ‚ùå Legal compliance reports

---

## üöÄ Next Steps

### ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Demo/Prototype:

```
‚úÖ ‡πÉ‡∏ä‡πâ Mock Data ‡∏ï‡πà‡∏≠‡πÑ‡∏õ
‚úÖ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Ñ‡∏£‡∏≤‡∏ß
‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Demo Data" ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
```

### ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Production:

```
1. ‡∏™‡∏°‡∏±‡∏Ñ‡∏£ SET API ‡πÅ‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£
2. ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ Alpha Vantage/Finnhub
3. Implement proper authentication
4. Setup monitoring ‡πÅ‡∏•‡∏∞ fallback
5. Add error tracking (Sentry)
```

---

## üìù Code Reference

### ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á:

```
‚úÖ src/app/api/stock/route.ts          (API proxy)
‚úÖ src/app/investor-financials/page.tsx (UI component)
‚úÖ src/data/mockStockData.ts           (Mock data)
‚úÖ .env.local                          (API keys)
```

### ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console:

```bash
# Server Console (Terminal)
üîÑ Attempting to fetch SET API...
   Trying Bearer Token...
   Trying X-API-Key...
   Trying Both Headers...
‚ùå All authentication methods failed: 401 Unauthorized

# Browser Console (DevTools)
API not available (401), using mock data
```

---

## üí° Recommendations

### ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Stakeholders:

**‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Ñ‡πà Demo:**

- ‚úÖ ‡πÉ‡∏ä‡πâ Mock Data ‡∏ï‡πà‡∏≠‡πÑ‡∏õ
- ‚úÖ ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡∏∞‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì
- ‚úÖ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ authentication

**‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á:**

- üìã ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ SET Marketplace
- üí∞ ‡∏à‡∏±‡∏î‡∏™‡∏£‡∏£‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì (‡∏ø5,000-20,000/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)
- ‚è±Ô∏è ‡πÉ‡∏´‡πâ‡πÄ‡∏ß‡∏•‡∏≤ 1-2 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö setup

**‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡πá‡∏ß + ‡∏ñ‡∏π‡∏Å:**

- üåü ‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ Alpha Vantage (Free tier)
- üîÑ Setup ‡πÉ‡∏ô 1 ‡∏ß‡∏±‡∏ô
- üíµ ‡∏ü‡∏£‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö basic usage

---

## üéØ ‡∏™‡∏£‡∏∏‡∏õ

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:** SET API ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ authentication ‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏ß‡πà‡∏≤ demo key

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:** ‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ Mock Data ‡πÅ‡∏ó‡∏ô (seamless fallback)

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**

- ‚úÖ ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥
- ‚úÖ User ‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô error
- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏à‡∏£‡∏¥‡∏á

**‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:**

- Demo/Prototype ‚Üí ‡πÉ‡∏ä‡πâ Mock Data ‡∏ï‡πà‡∏≠ ‚úÖ
- Production ‚Üí ‡∏™‡∏°‡∏±‡∏Ñ‡∏£ SET API ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∑‡πà‡∏ô üîÑ

---

**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:** October 16, 2025
**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:** ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß - ‡πÉ‡∏ä‡πâ Mock Data Fallback
**‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ:** ‚úÖ YES - http://localhost:3000/investor-financials
