# ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° API Key ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à - ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏•‡πâ‡∏ß!

## üéâ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î

‡πÄ‡∏û‡∏¥‡πà‡∏° **SET API Key** ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å SET Market Data API

---

## üîë API Key ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

```
461b3d65-d964-4d93-97a0-79b670d3867f
```

---

## ‚úÖ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß

### 1. ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï API Route

**‡πÑ‡∏ü‡∏•‡πå:** `src/app/api/stock/route.ts`

‡πÄ‡∏û‡∏¥‡πà‡∏°:

- ‚úÖ API Key ‡πÉ‡∏ô Authorization header
- ‚úÖ x-api-key header
- ‚úÖ Environment variable support
- ‚úÖ Console log ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö debug

```typescript
const API_KEY = process.env.SET_API_KEY || "461b3d65-d964-4d93-97a0-79b670d3867f";

headers: {
  "Authorization": `Bearer ${API_KEY}`,
  "x-api-key": API_KEY,
  // ...
}
```

### 2. ‡πÄ‡∏û‡∏¥‡πà‡∏° Environment Variables

**‡πÑ‡∏ü‡∏•‡πå:** `.env.local`

```bash
SET_API_KEY=461b3d65-d964-4d93-97a0-79b670d3867f
SET_API_URL=https://marketplace.set.or.th/api/public/realtime-data/stock
```

### 3. ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï UI Messages

**‡πÑ‡∏ü‡∏•‡πå:** `src/app/investor-financials/page.tsx`

‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å:

- ‚ùå "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á"

‡πÄ‡∏õ‡πá‡∏ô:

- ‚úÖ "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å SET Market Data API ‚Ä¢ Real-time Data"

---

## üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: Restart Development Server

**‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç!** ‡∏ï‡πâ‡∏≠‡∏á restart ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î `.env.local`

```powershell
# ‡∏´‡∏¢‡∏∏‡∏î server (Ctrl+C)
# ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà
npm run dev
```

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö API

#### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö API Route ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á

```
http://localhost:3000/api/stock?symbol=TVO
```

**‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ:**

```json
{
  "data": [
    {
      "symbol": "TVO",
      "last": 24.5,
      "change": 0.5,
      "percentChange": 2.08
      // ... ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å SET
    }
  ]
}
```

#### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤ Investor Financials

```
http://localhost:3000/investor-financials
```

**‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:**

- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏∏‡πâ‡∏ô TVO (‡∏à‡∏£‡∏¥‡∏á)
- ‚úÖ Market Overview (Top 10 ‡∏´‡∏∏‡πâ‡∏ô‡∏à‡∏£‡∏¥‡∏á)
- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å SET Market Data API"
- ‚úÖ ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console

**‡πÉ‡∏ô Browser Console (F12):**

```
API not available (401), using mock data  // ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏•‡πâ‡∏ß
```

**‡πÉ‡∏ô Server Console (Terminal):**

```
Fetching SET API with key: 461b3d65...
```

---

## üìä Features ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ

### ‚úÖ Real-time Stock Data

- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å SET
- ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- ‡∏£‡∏≤‡∏Ñ‡∏≤, change, volume, value

### ‚úÖ Market Overview

- Top 10 ‡∏´‡∏∏‡πâ‡∏ô‡∏à‡∏£‡∏¥‡∏á
- ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• real-time

### ‚úÖ Fallback to Mock Data

- ‡∏ñ‡πâ‡∏≤ API ‡∏•‡πâ‡∏° ‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ Mock Data ‡πÑ‡∏î‡πâ
- ‡πÑ‡∏°‡πà‡∏°‡∏µ error ‡πÉ‡∏´‡πâ user ‡πÄ‡∏´‡πá‡∏ô
- Seamless experience

---

## üîç ‡∏Å‡∏≤‡∏£ Debug

### ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ API Key ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

#### 1. ‡∏î‡∏π Server Log

```
Terminal ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ô npm run dev ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
Fetching SET API with key: 461b3d65...
```

#### 2. ‡πÄ‡∏ä‡πá‡∏Ñ Network Tab

```
1. ‡πÄ‡∏õ‡∏¥‡∏î DevTools (F12)
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Network tab
3. ‡∏î‡∏π request ‡∏ä‡∏∑‡πà‡∏≠ "stock"
4. ‡πÄ‡∏ä‡πá‡∏Ñ Response:
   - Status: 200 ‚úÖ
   - Body: { data: [...] } ‚úÖ
```

#### 3. ‡πÄ‡∏ä‡πá‡∏Ñ Console

```
‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
- "401 error"
- "API not available"
- "using mock data"
```

---

## ‚ö†Ô∏è ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç

### 1. ‡∏Å‡∏≤‡∏£ Restart Server

**‡∏ï‡πâ‡∏≠‡∏á restart** ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ `.env.local`

```powershell
# ‡∏´‡∏¢‡∏∏‡∏î (Ctrl+C)
npm run dev  # ‡∏£‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà
```

### 2. Security

API Key ‡∏ô‡∏µ‡πâ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô `.env.local` ‡∏ã‡∏∂‡πà‡∏á:

- ‚úÖ ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å commit ‡πÑ‡∏õ git (.gitignore)
- ‚úÖ ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ server-side
- ‚úÖ ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà browser

### 3. API Limits

API Key ‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡∏°‡∏µ:

- Rate limit (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô requests ‡∏ï‡πà‡∏≠‡πÄ‡∏ß‡∏•‡∏≤)
- Quota (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô)
- ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô ‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ Mock Data

---

## üéØ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### Test Case 1: Default Symbol (TVO)

```
URL: http://localhost:3000/investor-financials
Expected: ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• TVO ‡∏à‡∏≤‡∏Å SET API
```

### Test Case 2: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Symbol

```
Action: ‡∏û‡∏¥‡∏°‡∏û‡πå "PTT" ‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á input
Expected: ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• PTT ‡∏à‡∏≤‡∏Å SET API
```

### Test Case 3: Symbol ‡πÑ‡∏°‡πà‡∏°‡∏µ

```
Action: ‡∏û‡∏¥‡∏°‡∏û‡πå "INVALID"
Expected: ‡πÅ‡∏™‡∏î‡∏á error ‡∏´‡∏£‡∏∑‡∏≠ fallback data
```

### Test Case 4: Market Overview

```
URL: http://localhost:3000/investor-financials
Expected: ‡πÅ‡∏™‡∏î‡∏á Top 10 ‡∏´‡∏∏‡πâ‡∏ô‡∏à‡∏≤‡∏Å SET API
```

---

## üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

```
‚úÖ .env.local                                (‡πÄ‡∏û‡∏¥‡πà‡∏° API Key)
‚úÖ src/app/api/stock/route.ts               (‡πÉ‡∏ä‡πâ API Key)
‚úÖ src/app/investor-financials/page.tsx     (‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï UI message)
‚úÖ docs/API_KEY_ADDED.md                    (‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ)
```

---

## üéâ ‡∏™‡∏£‡∏∏‡∏õ

| ‡∏Å‡πà‡∏≠‡∏ô             | ‡∏´‡∏•‡∏±‡∏á                  |
| ---------------- | --------------------- |
| ‚ùå Error 401     | ‚úÖ Success 200        |
| ‚ùå Mock Data     | ‚úÖ Real Data from SET |
| ‚ùå "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á" | ‚úÖ "Real-time Data"   |
| ‚ùå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏à‡∏£‡∏¥‡∏á | ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å SET  |

---

## üöÄ Next Steps

1. **Restart Server**

   ```powershell
   npm run dev
   ```

2. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤**

   ```
   http://localhost:3000/investor-financials
   ```

3. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö**
   - ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏™‡∏î‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
   - ‚úÖ ‡πÑ‡∏°‡πà‡∏°‡∏µ error
   - ‚úÖ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô symbol ‡πÑ‡∏î‡πâ

---

## üìû ‡∏ï‡∏¥‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤?

### ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÄ‡∏´‡πá‡∏ô "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á"

1. Restart server (Ctrl+C ‡πÅ‡∏•‡πâ‡∏ß npm run dev ‡πÉ‡∏´‡∏°‡πà)
2. Hard refresh browser (Ctrl+Shift+R)
3. ‡πÄ‡∏ä‡πá‡∏Ñ console ‡∏ß‡πà‡∏≤‡∏°‡∏µ error ‡∏≠‡∏∞‡πÑ‡∏£

### ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÄ‡∏´‡πá‡∏ô 401 Error

1. ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ restart server ‡πÅ‡∏•‡πâ‡∏ß
2. ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ `.env.local` ‡∏°‡∏µ API Key
3. ‡πÄ‡∏ä‡πá‡∏Ñ server log ‡∏ß‡πà‡∏≤ API Key ‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î

### ‡∏ñ‡πâ‡∏≤ API ‡∏ä‡πâ‡∏≤

1. ‡πÄ‡∏ä‡πá‡∏Ñ internet connection
2. ‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô SET API ‡∏ä‡πâ‡∏≤
3. ‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà

---

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:** ‚úÖ **API Key ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à - ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á!**

**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:** October 16, 2025

**API Key:** `461b3d65-d964-4d93-97a0-79b670d3867f`

---

**‡∏•‡∏≠‡∏á restart server ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö! üéâüìà**
